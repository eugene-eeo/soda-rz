#!/usr/bin/env python

import argparse
import sys
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt


def main():
    parser = argparse.ArgumentParser(description='Plot data generated by sim')
    parser.add_argument('filename', metavar='filename', type=str,
                    help='file to plot')
    parser.add_argument('--dpi', dest='dpi', default=300, type=int,
                    help='toggle dpi of plotted figure')
    args = parser.parse_args()

    df = pd.read_json(sys.stdin)
    sns.set_style('whitegrid')
    levels = df.nunique().get_value('level')

    g = sns.FacetGrid(df, col='level', sharex=False, col_wrap=4)
    g.map(plt.bar, 'damage', 'probability', color='black', linewidth=0.5)
    plt.savefig(args.filename, dpi=args.dpi)


if __name__ == '__main__':
    main()
